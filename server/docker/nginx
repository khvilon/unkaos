FROM node:23.5.0-alpine as build

WORKDIR /app

# Устанавливаем переменную для определения контейнерного окружения
ENV VITE_CONTAINER=true

# Копируем сначала только файлы для установки зависимостей
COPY ./www/package.json .
RUN yarn install

# Затем копируем остальные файлы и собираем
COPY ./www .
RUN yarn build

FROM nginx:1.27.3-alpine
COPY --from=build /app/dist /usr/share/nginx/html
